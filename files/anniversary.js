(()=>{var t={344:(t,e,i)=>{var s=i(202);t.exports=(s.default||s).template({compiler:[8,">= 4.3.0"],main:function(t,e,i,s,r){return'<div class="random-fireworks">\n\t<button type="button">放烟花</button>\n</div>\n'},useData:!0})},834:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}e.__esModule=!0;var o=r(i(67)),n=s(i(558)),a=s(i(728)),h=r(i(392)),l=r(i(628)),c=s(i(982));function d(){var t=new o.HandlebarsEnvironment;return h.extend(t,o),t.SafeString=n.default,t.Exception=a.default,t.Utils=h,t.escapeExpression=h.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var u=d();u.create=d,c.default(u),u.default=u,e.default=u,t.exports=e.default},67:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=d;var r=i(392),o=s(i(728)),n=i(638),a=i(881),h=s(i(37)),l=i(293);e.VERSION="4.7.7",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var c="[object Object]";function d(t,e,i){this.helpers=t||{},this.partials=e||{},this.decorators=i||{},n.registerDefaultHelpers(this),a.registerDefaultDecorators(this)}d.prototype={constructor:d,logger:h.default,log:h.default.log,registerHelper:function(t,e){if(r.toString.call(t)===c){if(e)throw new o.default("Arg not supported with multiple helpers");r.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(r.toString.call(t)===c)r.extend(this.partials,t);else{if(void 0===e)throw new o.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(r.toString.call(t)===c){if(e)throw new o.default("Arg not supported with multiple decorators");r.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var u=h.default.log;e.log=u,e.createFrame=r.createFrame,e.logger=h.default},881:(t,e,i)=>{"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){r.default(t)};var s,r=(s=i(670))&&s.__esModule?s:{default:s}},670:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392);e.default=function(t){t.registerDecorator("inline",(function(t,e,i,r){var o=t;return e.partials||(e.partials={},o=function(r,o){var n=i.partials;i.partials=s.extend({},n,e.partials);var a=t(r,o);return i.partials=n,a}),e.partials[r.args[0]]=r.fn,o}))},t.exports=e.default},728:(t,e)=>{"use strict";e.__esModule=!0;var i=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function s(t,e){var r=e&&e.loc,o=void 0,n=void 0,a=void 0,h=void 0;r&&(o=r.start.line,n=r.end.line,a=r.start.column,h=r.end.column,t+=" - "+o+":"+a);for(var l=Error.prototype.constructor.call(this,t),c=0;c<i.length;c++)this[i[c]]=l[i[c]];Error.captureStackTrace&&Error.captureStackTrace(this,s);try{r&&(this.lineNumber=o,this.endLineNumber=n,Object.defineProperty?(Object.defineProperty(this,"column",{value:a,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:h,enumerable:!0})):(this.column=a,this.endColumn=h))}catch(t){}}s.prototype=new Error,e.default=s,t.exports=e.default},638:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){r.default(t),o.default(t),n.default(t),a.default(t),h.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,i){t.helpers[e]&&(t.hooks[e]=t.helpers[e],i||delete t.helpers[e])};var r=s(i(342)),o=s(i(822)),n=s(i(905)),a=s(i(405)),h=s(i(702)),l=s(i(593)),c=s(i(978))},342:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,i){var r=i.inverse,o=i.fn;if(!0===e)return o(this);if(!1===e||null==e)return r(this);if(s.isArray(e))return e.length>0?(i.ids&&(i.ids=[i.name]),t.helpers.each(e,i)):r(this);if(i.data&&i.ids){var n=s.createFrame(i.data);n.contextPath=s.appendContextPath(i.data.contextPath,i.name),i={data:n}}return o(e,i)}))},t.exports=e.default},822:(t,e,i)=>{"use strict";e.__esModule=!0;var s,r=i(392),o=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new o.default("Must pass iterator to #each");var s,n=e.fn,a=e.inverse,h=0,l="",c=void 0,d=void 0;function u(e,i,s){c&&(c.key=e,c.index=i,c.first=0===i,c.last=!!s,d&&(c.contextPath=d+e)),l+=n(t[e],{data:c,blockParams:r.blockParams([t[e],e],[d+e,null])})}if(e.data&&e.ids&&(d=r.appendContextPath(e.data.contextPath,e.ids[0])+"."),r.isFunction(t)&&(t=t.call(this)),e.data&&(c=r.createFrame(e.data)),t&&"object"==typeof t)if(r.isArray(t))for(var f=t.length;h<f;h++)h in t&&u(h,h,h===t.length-1);else if(i.g.Symbol&&t[i.g.Symbol.iterator]){for(var p=[],g=t[i.g.Symbol.iterator](),m=g.next();!m.done;m=g.next())p.push(m.value);for(f=(t=p).length;h<f;h++)u(h,h,h===t.length-1)}else s=void 0,Object.keys(t).forEach((function(t){void 0!==s&&u(s,h-1),s=t,h++})),void 0!==s&&u(s,h-1,!0);return 0===h&&(l=a(this)),l}))},t.exports=e.default},905:(t,e,i)=>{"use strict";e.__esModule=!0;var s,r=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new r.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},405:(t,e,i)=>{"use strict";e.__esModule=!0;var s,r=i(392),o=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new o.default("#if requires exactly one argument");return r.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||r.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,i){if(2!=arguments.length)throw new o.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}))},t.exports=e.default},702:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],i=arguments[arguments.length-1],s=0;s<arguments.length-1;s++)e.push(arguments[s]);var r=1;null!=i.hash.level?r=i.hash.level:i.data&&null!=i.data.level&&(r=i.data.level),e[0]=r,t.log.apply(t,e)}))},t.exports=e.default},593:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,i){return t?i.lookupProperty(t,e):t}))},t.exports=e.default},978:(t,e,i)=>{"use strict";e.__esModule=!0;var s,r=i(392),o=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new o.default("#with requires exactly one argument");r.isFunction(t)&&(t=t.call(this));var i=e.fn;if(r.isEmpty(t))return e.inverse(this);var s=e.data;return e.data&&e.ids&&((s=r.createFrame(e.data)).contextPath=r.appendContextPath(e.data.contextPath,e.ids[0])),i(t,{data:s,blockParams:r.blockParams([t],[s&&s.contextPath])})}))},t.exports=e.default},572:(t,e,i)=>{"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return s.extend.apply(void 0,[Object.create(null)].concat(e))};var s=i(392)},293:(t,e,i)=>{"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var i=Object.create(null);return i.__proto__=!1,{properties:{whitelist:s.createNewLookupObject(i,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:s.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,i){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==o[t]&&(o[t]=!0,r.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,i)},e.resetLoggedProperties=function(){Object.keys(o).forEach((function(t){delete o[t]}))};var s=i(572),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(37)),o=Object.create(null)},5:(t,e)=>{"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){var i=arguments[arguments.length-1];return arguments[arguments.length-1]=e(i),t.apply(this,arguments)}}},37:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392),r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=s.indexOf(r.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=r.lookupLevel(t),"undefined"!=typeof console&&r.lookupLevel(r.level)<=t){var e=r.methodMap[t];console[e]||(e="log");for(var i=arguments.length,s=Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];console[e].apply(console,s)}}};e.default=r,t.exports=e.default},982:(t,e,i)=>{"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==i.g?i.g:window,s=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=s),t}},t.exports=e.default},628:(t,e,i)=>{"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,i=n.COMPILER_REVISION;if(!(e>=n.LAST_COMPATIBLE_COMPILER_REVISION&&e<=n.COMPILER_REVISION)){if(e<n.LAST_COMPATIBLE_COMPILER_REVISION){var s=n.REVISION_CHANGES[i],r=n.REVISION_CHANGES[e];throw new o.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+s+") or downgrade your runtime to an older version ("+r+").")}throw new o.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new o.default("No environment passed to template");if(!t||!t.main)throw new o.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var i=t.compiler&&7===t.compiler[0],s={strict:function(t,e,i){if(!t||!(e in t))throw new o.default('"'+e+'" not defined in '+t,{loc:i});return s.lookupProperty(t,e)},lookupProperty:function(t,e){var i=t[e];return null==i||Object.prototype.hasOwnProperty.call(t,e)||l.resultIsAllowed(i,s.protoAccessControl,e)?i:void 0},lookup:function(t,e){for(var i=t.length,r=0;r<i;r++)if(null!=(t[r]&&s.lookupProperty(t[r],e)))return t[r][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:r.escapeExpression,invokePartial:function(i,s,n){n.hash&&(s=r.extend({},s,n.hash),n.ids&&(n.ids[0]=!0)),i=e.VM.resolvePartial.call(this,i,s,n);var a=r.extend({},n,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),h=e.VM.invokePartial.call(this,i,s,a);if(null==h&&e.compile&&(n.partials[n.name]=e.compile(i,t.compilerOptions,e),h=n.partials[n.name](s,a)),null!=h){if(n.indent){for(var l=h.split("\n"),c=0,d=l.length;c<d&&(l[c]||c+1!==d);c++)l[c]=n.indent+l[c];h=l.join("\n")}return h}throw new o.default("The partial "+n.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var i=t[e];return i.decorator=t[e+"_d"],i},programs:[],program:function(t,e,i,s,r){var o=this.programs[t],n=this.fn(t);return e||r||s||i?o=c(this,t,n,e,i,s,r):o||(o=this.programs[t]=c(this,t,n)),o},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var i=t||e;return t&&e&&t!==e&&(i=r.extend({},e,t)),i},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function n(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=i.data;n._setup(i),!i.partial&&t.useData&&(r=u(e,r));var o=void 0,a=t.useBlockParams?[]:void 0;function h(e){return""+t.main(s,e,s.helpers,s.partials,r,a,o)}return t.useDepths&&(o=i.depths?e!=i.depths[0]?[e].concat(i.depths):i.depths:[e]),(h=f(t.main,h,s,i.depths||[],r,a))(e,i)}return n.isTop=!0,n._setup=function(o){if(o.partial)s.protoAccessControl=o.protoAccessControl,s.helpers=o.helpers,s.partials=o.partials,s.decorators=o.decorators,s.hooks=o.hooks;else{var n=r.extend({},e.helpers,o.helpers);!function(t,e){Object.keys(t).forEach((function(i){var s=t[i];t[i]=function(t,e){var i=e.lookupProperty;return h.wrapHelper(t,(function(t){return r.extend({lookupProperty:i},t)}))}(s,e)}))}(n,s),s.helpers=n,t.usePartial&&(s.partials=s.mergeIfNeeded(o.partials,e.partials)),(t.usePartial||t.useDecorators)&&(s.decorators=r.extend({},e.decorators,o.decorators)),s.hooks={},s.protoAccessControl=l.createProtoAccessControl(o);var c=o.allowCallsToHelperMissing||i;a.moveHelperToHooks(s,"helperMissing",c),a.moveHelperToHooks(s,"blockHelperMissing",c)}},n._child=function(e,i,r,n){if(t.useBlockParams&&!r)throw new o.default("must pass block params");if(t.useDepths&&!n)throw new o.default("must pass parent depths");return c(s,e,t[e],i,0,r,n)},n},e.wrapProgram=c,e.resolvePartial=function(t,e,i){return t?t.call||i.name||(i.name=t,t=i.partials[t]):t="@partial-block"===i.name?i.data["partial-block"]:i.partials[i.name],t},e.invokePartial=function(t,e,i){var s=i.data&&i.data["partial-block"];i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var a=void 0;if(i.fn&&i.fn!==d&&function(){i.data=n.createFrame(i.data);var t=i.fn;a=i.data["partial-block"]=function(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return i.data=n.createFrame(i.data),i.data["partial-block"]=s,t(e,i)},t.partials&&(i.partials=r.extend({},i.partials,t.partials))}(),void 0===t&&a&&(t=a),void 0===t)throw new o.default("The partial "+i.name+" could not be found");if(t instanceof Function)return t(e,i)},e.noop=d;var s,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(392)),o=(s=i(728))&&s.__esModule?s:{default:s},n=i(67),a=i(638),h=i(5),l=i(293);function c(t,e,i,s,r,o,n){function a(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=n;return!n||e==n[0]||e===t.nullContext&&null===n[0]||(a=[e].concat(n)),i(t,e,t.helpers,t.partials,r.data||s,o&&[r.blockParams].concat(o),a)}return(a=f(i,a,t,n,s,o)).program=e,a.depth=n?n.length:0,a.blockParams=r||0,a}function d(){return""}function u(t,e){return e&&"root"in e||((e=e?n.createFrame(e):{}).root=t),e}function f(t,e,i,s,o,n){if(t.decorator){var a={};e=t.decorator(e,a,i,s&&s[0],o,n,s),r.extend(e,a)}return e}},558:(t,e)=>{"use strict";function i(t){this.string=t}e.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},e.default=i,t.exports=e.default},392:(t,e)=>{"use strict";e.__esModule=!0,e.extend=n,e.indexOf=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return r.test(t)?t.replace(s,o):t},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=n({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},s=/[&<>"'`=]/g,r=/[&<>"'`=]/;function o(t){return i[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&(t[i]=arguments[e][i]);return t}var a=Object.prototype.toString;e.toString=a;var h=function(t){return"function"==typeof t};h(/x/)&&(e.isFunction=h=function(t){return"function"==typeof t&&"[object Function]"===a.call(t)}),e.isFunction=h;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===a.call(t)};e.isArray=l},202:(t,e,i)=>{t.exports=i(834).default}},e={};function i(s){var r=e[s];if(void 0!==r)return r.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";class t extends HTMLElement{constructor(){super(),this.checkedAttributes=new Map}static get observedAttributes(){return[]}createShadowDom(t="",e=""){this.attachShadow({mode:"open"}),""!==t&&(t=`<style>${t}</style>`),this.shadowRoot.innerHTML=`${t}${e}`}handleAttributesChange(){}attributeChangedCallback(t,e,i){let s="";this.checkedAttributes.has(t)?s=this.checkedAttributes.get(t):(s="handle"+t.split("-").map((t=>t.substr(0,1).toUpperCase()+t.substr(1))).join("")+"Change",s in this||(s=""),this.checkedAttributes.set(t,s)),""!==s&&this[s](),this.handleAttributesChange()}}class e{constructor(t,e){this.nextRenderId=0,this.started=!1,this.nextFrameTime=0,this.needRender=!1,this.bgImage=null,this.bgColor="",this.globalOpacity=0,this.glowTime=0,this.renderList=t,this.context=e,this.requestNextRender=window.requestAnimationFrame,this.renderCallback=this.render.bind(this),this.renderObservers=new Set,this.nextRenderHandlers=new Set}get canvas(){return this.context.canvas}get backgroundColor(){return this.bgColor}set backgroundColor(t){this.bgColor=t,this.requestRender()}setBackgroundImage(t){return""===t?(this.bgImage=null,this.requestRender(),Promise.resolve()):new Promise((e=>{const i=new Image;i.addEventListener("load",(()=>{this.bgImage=i,this.requestRender(),e()})),i.crossOrigin="anonymous",i.src=t}))}useGlowTail(){if(this.glowCanvas)return;const t=this.context.canvas;this.glowCanvas=document.createElement("canvas"),this.glowCanvas.width=t.width,this.glowCanvas.height=t.height,this.glowCanvasContext=this.glowCanvas.getContext("2d")}start(){return this.started&&this.finish(),this.glowTime=0,this.globalOpacity=0,this.started=!0,this.render(),this}finish(){return this.started=!1,window.cancelAnimationFrame(this.nextRenderId),this}observe(t){this.renderObservers.add(t)}requestRender(t=null){this.needRender=!0,null!==t&&this.nextRenderHandlers.add(t)}render(){const t=Date.now();if(this.nextRenderId=this.requestNextRender.call(window,this.renderCallback),t<this.nextFrameTime)return;this.nextFrameTime=t+41,this.renderList.interrupt(),this.nextRenderHandlers.size>0&&(this.nextRenderHandlers.forEach((t=>t())),this.nextRenderHandlers.clear());const e=this.context.canvas;!this.renderList.needRender&&!this.needRender&&this.globalOpacity>=1&&0===this.glowTime||(this.globalOpacity<1&&(this.globalOpacity+=.1),this.prepareCanvasBeforeRender(),(this.renderList.needRender||this.needRender)&&this.glowCanvas&&(this.glowTime=5),this.context.globalAlpha=this.globalOpacity,this.bgColor&&(this.context.fillStyle=this.bgColor,this.context.fillRect(0,0,e.width,e.height)),this.drawBgImage(),this.needRender=!1,this.renderList.render(this.context),this.renderObservers.size>0&&this.renderObservers.forEach((t=>t())))}prepareCanvasBeforeRender(){const t=this.context.canvas;this.glowCanvasContext&&this.glowTime>1?(this.glowCanvas.width===t.width&&this.glowCanvas.height===t.height||(this.glowCanvas.width=t.width,this.glowCanvas.height=t.height),this.glowCanvasContext.clearRect(0,0,t.width,t.height),this.glowCanvasContext.drawImage(t,0,0),this.context.clearRect(0,0,t.width,t.height),this.context.globalAlpha=.5,this.context.drawImage(this.glowCanvas,0,0),this.context.globalAlpha=1,this.glowTime--):this.context.clearRect(0,0,t.width,t.height)}drawBgImage(){if(!this.bgImage||!this.bgImage.complete||0===this.bgImage.naturalWidth)return;const t=this.bgImage.naturalWidth,e=this.canvas.height-this.bgImage.naturalHeight,i=Math.ceil(this.canvas.width/t);for(let s=0;s<i;s++)this.context.drawImage(this.bgImage,s*t,e)}}class s{constructor(){this.isChangedByInterruption=!1,this.isChangedList=!1,this.list=new Set,this.waitList=new Set,this.beforeRenderCallbacks=new WeakMap,this.afterRenderCallbacks=new WeakMap}clear(){this.list.clear(),this.waitList.clear(),this.isChangedList=!0}add(t,e=0,i=null,s=null){return e>0?this.waitList.add({element:t,wait:e}):this.list.add(t),"function"==typeof i&&this.beforeRenderCallbacks.set(t,i),"function"==typeof s&&this.afterRenderCallbacks.set(t,s),this.isChangedList=!0,this}remove(t){for(const e of this.waitList)if(e.element===t){this.waitList.delete(e);break}return this.list.delete(t),this.isChangedList=!0,this}getBoundingRect(){const t={x:Number.MAX_VALUE,y:Number.MAX_VALUE},e={x:0,y:0};for(const i of this.list){const{x:s,y:r,width:o,height:n}=i.getBoundingRect();t.x=Math.min(t.x,s),t.y=Math.min(t.y,r),e.x=Math.max(e.x,s+o),e.y=Math.max(e.y,r+n)}return{x:t.x,y:t.y,width:e.x-t.x,height:e.y-t.y}}getElementUnderPoint(t){for(const e of[...this.list].reverse()){const{x:i,y:s,width:r,height:o}=e.getBoundingRect();if(t.x>i&&t.x<i+r&&t.y>s&&t.y<s+o)return e}return null}get isEnded(){return!(this.waitList.size>0)&&(0===this.list.size||[...this.list].every((t=>t.isEnded)))}get needRender(){return this.isChangedByInterruption||this.isChangedList}interrupt(){let t=!1;for(const e of this.list)e.isEnded?(this.list.delete(e),t=!0):e.interrupt()&&(t=!0);for(const e of this.waitList)0==--e.wait&&(this.waitList.delete(e),this.list.add(e.element),t=!0);return this.isChangedByInterruption=t,t}render(t){this.isChangedList=!1,this.isChangedByInterruption=!1;for(const e of this.list)this.beforeRenderCallbacks.has(e)&&(t.save(),this.beforeRenderCallbacks.get(e)(t),t.restore()),t.save(),e.render(t),t.restore(),this.afterRenderCallbacks.has(e)&&(t.save(),this.afterRenderCallbacks.get(e)(t),t.restore())}}const r=Math.PI/180,o=180/Math.PI,n=2*Math.PI,a=Math.PI/2;function h(t,e=1,i=0){return Math.max(i,Math.max(i,t))}function l(t,e=0,i){return e+t*(i-e)}function c(t=1e3){return Math.round(Math.random()*t)/t}function d(t,e=0){return e+Math.random()*(t-e)}function u(t,e,i,s){const r=1-t,o=r**2,n=t**2;return{x:o*e.x+2*r*t*i.x+n*s.x,y:o*e.y+2*r*t*i.y+n*s.y}}const f=new Map;var p;!function(t){t.LAUNCH_1="launch-1.mp3",t.EXPLOSION_1="explosion-1.mp3",t.EXPLOSION_2="explosion-2.mp3",t.EXPLOSION_FIZZ="explosion-fizz.mp3"}(p||(p={}));let g=.3,m=!1;class v{constructor(t){this.fileName=t,this.wasPlayed=!1,this.canPlay=!0,this.isLoading=!1,this.filePath=v.assetsUrl+"/"+this.fileName,f.has(this.filePath)&&(this.audio=f.get(this.filePath).cloneNode(!0),this.audio.volume=g)}static get disabled(){return m}static set disabled(t){m=t}static muteAll(t){g=t?0:.3}play(){return!(!m&&!this.wasPlayed&&this.canPlay&&(this.isLoading||this.playWhenReady().then(),1))}preloadFile(){if(f.has(this.filePath))return;const t=new Audio;t.volume=g,t.autoplay=!1,t.src=this.filePath,f.set(this.filePath,t)}async playWhenReady(){m||(this.isLoading=!0,f.has(this.filePath)||this.preloadFile(),this.audio||(this.audio=f.get(this.filePath).cloneNode(!0)),this.audio.volume=g,this.wasPlayed=!0,await this.audio.play(),this.isLoading=!1)}}v.assetsUrl="./sounds";const w=["#ff5b5b","#ffd449","#c4ff21","#21ff60","#21f8ff","#41b4ff","#d466ff","#ff66c2","#ffffe7"],y="#fff",M=["#a95e47","#bca047","#819d4a","#7ed070","#73bbc8","#8a8bf5","#ab80bc","#ec2f8d","#acaca3"];function b(t,e=w){const i=[...e];t=Math.min(t,i.length);const s=[];for(;t-- >0;)s.push(i.splice(Math.round(1e3*Math.random())%i.length,1)[0]);return s}var x;!function(t){t[t.MIN_PEAKS=9]="MIN_PEAKS",t[t.MAX_PEAKS=15]="MAX_PEAKS",t[t.MIN_DISTANCE=20]="MIN_DISTANCE",t[t.MAX_DISTANCE=40]="MAX_DISTANCE"}(x||(x={}));class E{constructor(t){var e,i;this.sound=null,this.stage=0,this.opacity=1,this.angleStepDeg=0,this.glowRadius1=5,this.glowRadius2=10,this.pos=t.position||{x:0,y:0},this.color=(null==t?void 0:t.colors[0])||y,this.distance=l(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,x.MIN_DISTANCE,x.MAX_DISTANCE),this.angleStepDeg=360/(2*l(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,x.MIN_PEAKS,x.MAX_PEAKS)),t.noSound||(this.sound=new v(p.EXPLOSION_1))}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){return this.stage>=3}interrupt(){var t;if(!1===(null===(t=this.sound)||void 0===t?void 0:t.play()))return!1;switch(this.stage){case 0:this.pathGlow=this.generatePath(1,180*Math.random()),this.pathLight=this.generatePath(.5,180*Math.random()),this.glowRadius1=.3*this.distance,this.glowRadius2=.7*this.distance;break;case 1:this.pathGlow=this.generatePath(2,180*Math.random()),this.pathLight=this.generatePath(1,180*Math.random()),this.glowRadius1=.5*this.distance,this.glowRadius2=1.2*this.distance;break;case 2:this.pathGlow=null,this.pathLight=this.generatePath(.5,180*Math.random()),this.glowRadius1=this.distance,this.glowRadius2=2*this.distance,this.opacity=.4}return++this.stage,!0}render(t){if(t.translate(this.pos.x,this.pos.y),this.glowRadius2>0){const e=t.createRadialGradient(0,0,this.glowRadius1,0,0,this.glowRadius2);e.addColorStop(0,"rgba(255, 255, 255, 0.3)"),e.addColorStop(1,"rgba(255, 255, 255, 0)"),t.globalAlpha=this.opacity,t.fillStyle=e,t.fillRect(-this.glowRadius2,-this.glowRadius2,this.glowRadius2<<1,this.glowRadius2<<1)}this.pathGlow&&(t.fillStyle=this.color,t.globalAlpha=.7*this.opacity,E.drawPath(this.pathGlow,t)),this.pathLight&&(t.fillStyle="#ffffff",t.globalAlpha=this.opacity,E.drawPath(this.pathLight,t))}static drawPath(t,e){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.fill()}generatePath(t,e=0){const i=this.distance*t,s=.3*i,o=Math.floor(360/this.angleStepDeg),n=[];for(let t=0;t<o;t++){let o=e+this.angleStepDeg*t;o+=this.angleStepDeg*(.3*Math.random()-.3),o*=r;let a=1==(1&t)?s:i;a*=.4+.6*Math.random(),n.push({x:a*Math.cos(o),y:a*Math.sin(o)})}return n}}const C=.05;class _{constructor(t=20,e=2){this.length=t,this.pointSize=e,this.points=[],this.halfSize=e/2,this.opacityStep=1/t}addPoint(t){if(0===this.points.length)return this.points.push({...t,opacity:1}),this;const e=this.points[0],i=t.x-e.x,s=t.y-e.y,r=Math.ceil(Math.max(Math.abs(i),Math.abs(s))/this.pointSize);if(r<=1)return this.points.unshift({...t,opacity:1}),this;const o=i/r,n=s/r,a=(1-e.opacity)/r;for(let t=1;t<=r;t++)this.points.unshift({x:e.x+o*t,y:e.y+n*t,opacity:e.opacity+a*t});return this}getBoundingRect(){const t={x:Number.MAX_VALUE,y:Number.MAX_VALUE},e={x:0,y:0};for(const i of this.points)t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),e.x=Math.max(e.x,i.x),e.y=Math.max(e.y,i.y);return{x:t.x,y:t.y,width:e.x-t.x,height:e.y-t.y}}get isEnded(){for(const t of this.points)if(t.opacity>C)return!1;return!0}interrupt(){this.points.length>300&&this.points.splice(200);for(const t of this.points){if(t.opacity<=C)break;t.opacity/=2}return!0}render(t){let e=1;for(let i=0;i<this.points.length&&i<this.length;i++){const s=this.points[i];if(s.opacity<=C)break;t.globalAlpha=e>s.opacity?s.opacity:e,t.fillRect(s.x-this.halfSize,s.y-this.halfSize,this.pointSize,this.pointSize),e-=this.opacityStep}}}class S{constructor(t,e,i){var s,r;this.distance=e,this.sound=null,this.time=0,this.value=0,this.duration=0,this.opacity=1,this.elements=[],this.colors=t.colors||[y],this.pos={...t.position||{x:0,y:0}},this.elements=this.generateElements(i),this.explosionType0=new E({colors:[this.colors[0]],position:this.pos,sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(r=t.elementsFactor)&&void 0!==r?r:.5,noSound:!0}),t.noSound||(this.sound=new v(p.EXPLOSION_2))}getRandomColor(){return this.colors[Math.ceil(1e3*Math.random())%this.colors.length]}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){var t,e;if(this.time<this.duration)return!1;for(const e of this.elements)if(!1===(null===(t=e.tail)||void 0===t?void 0:t.isEnded))return!1;return!1!==(null===(e=this.explosionType0)||void 0===e?void 0:e.isEnded)}interrupt(){var t,e,i,s;if(!1===(null===(t=this.sound)||void 0===t?void 0:t.play()))return!1;for(const t of this.elements)null===(e=t.tail)||void 0===e||e.interrupt();if(this.explosionType0&&(this.explosionType0.isEnded?this.explosionType0=null:this.explosionType0.interrupt()),this.time>=this.duration)return!0;this.value=1===(s=Math.min(1,this.time/this.duration))?1:1-Math.pow(2,-10*s);const r=1*this.time;for(const t of this.elements){const e=this.value*t.distance;t.x=t.xFactor*e+t.xFactor*r,t.y=t.yFactor*e+r,null===(i=t.tail)||void 0===i||i.addPoint({x:t.x,y:t.y})}return this.time>=this.duration-10&&(this.opacity=(this.duration-this.time)/10),++this.time,!0}render(t){var e;if(t.save(),t.translate(this.pos.x,this.pos.y),this.time<this.duration){t.globalAlpha=.3*this.opacity;for(const e of this.elements)t.fillStyle=e.color,t.beginPath(),t.arc(e.x,e.y,6,0,n),t.fill()}for(const i of this.elements)t.fillStyle=i.color,null===(e=i.tail)||void 0===e||e.render(t);if(this.time<this.duration){t.globalAlpha=this.opacity,t.fillStyle="#fff";for(const e of this.elements)t.fillRect(e.x-1,e.y-1,2,2)}t.restore(),this.explosionType0&&this.explosionType0.render(t)}}var k;!function(t){t[t.MIN_ELEMENTS=10]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=50]="MAX_ELEMENTS",t[t.MIN_DISTANCE=100]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(k||(k={}));class A extends S{constructor(t){var e,i;super(t,l(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,k.MIN_DISTANCE,k.MAX_DISTANCE),l(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,k.MIN_ELEMENTS,k.MAX_ELEMENTS)),this.duration=15}generateElements(t){let e=0;const i=360/t,s=[];for(let o=0;o<t;o++)e=i*o,e+=i*(.4*Math.random()*2-.4),e*=r,s.push({distance:this.distance*(.5+.5*Math.random()),xFactor:Math.cos(e),yFactor:Math.sin(e),tail:new _(30,2).addPoint({x:0,y:0}),color:this.getRandomColor(),x:0,y:0});return s}}var I,P,N;!function(t){t[t.MIN_ELEMENTS=15]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=30]="MAX_ELEMENTS",t[t.MIN_DISTANCE=130]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(I||(I={}));class F extends S{constructor(t){var e,i;super(t,l(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,I.MIN_DISTANCE,I.MAX_DISTANCE),l(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,I.MIN_ELEMENTS,I.MAX_ELEMENTS)),this.duration=20}generateElements(t){const e=[],i=Math.PI/t;let s=0;for(let r=0;r<t;r++){const o=i*r,n=Math.cos(o),a=Math.sin(o),h=Math.max(1,Math.ceil(t*a)),l=Math.PI/h;for(let t=0;t<h;t++){let i=a*Math.cos(l*t);i+=.02*Math.random()*2-.02;const r=n+(.02*Math.random()*2-.02),o=++s%3==0;e.push({x:0,y:0,distance:this.distance*(.05*Math.random()*2-.05+1),xFactor:i,yFactor:r,color:this.getRandomColor(),tail:o?new _(9,2).addPoint({x:0,y:0}):null})}}return e}}!function(t){t[t.MIN_ELEMENTS=30]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=60]="MAX_ELEMENTS",t[t.MIN_DISTANCE=200]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(P||(P={}));class L extends S{constructor(t){var e,i;super(t,l(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,P.MIN_DISTANCE,P.MAX_DISTANCE),l(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,P.MIN_ELEMENTS,P.MAX_ELEMENTS)),this.duration=15}generateElements(t){let e=0;const i=360/t,s=[],o=Math.random()*n,a=Math.cos(o),h=Math.sin(o);for(let o=0;o<t;o++){e=i*o,e+=i*(.1*Math.random()*2-.1),e*=r;let t=Math.cos(e),n=Math.sin(e)/5;s.push({distance:this.distance,xFactor:t*a-n*h,yFactor:t*h+n*a,tail:new _(6,2).addPoint({x:0,y:0}),color:this.getRandomColor(),x:0,y:0})}return s}}!function(t){t[t.MIN_ELEMENTS=15]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=50]="MAX_ELEMENTS",t[t.MIN_DISTANCE=100]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(N||(N={}));class R{constructor(t){var e,i;this.time=0,this.points=[],this.pos=t.position||{x:0,y:0},this.color=t.colors[0]||y,this.elementsCount=l(null!==(e=t.elementsFactor)&&void 0!==e?e:.5,N.MIN_ELEMENTS,N.MAX_ELEMENTS),this.distance=l(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,N.MIN_DISTANCE,N.MAX_DISTANCE)}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){return this.elementsCount<=0}interrupt(){this.points=[];for(let t=0;t<this.elementsCount;t++){const t=Math.random()*n,e=Math.random()*this.distance;this.points.push({x:Math.cos(t)*e,y:Math.sin(t)*e})}return this.pos.y+=2,this.elementsCount-=2,!0}render(t){t.translate(this.pos.x,this.pos.y),t.globalAlpha=.5,t.fillStyle=this.color;for(const e of this.points)t.fillRect(e.x-1,e.y-4,2,8),t.fillRect(e.x-4,e.y-1,8,2);t.fillStyle="#fff",t.globalAlpha=1;for(const e of this.points)t.fillRect(e.x-1,e.y-1,2,2)}}const T=Math.ceil(12),O="#fff8df";var H;!function(t){t[t.WAIT=0]="WAIT",t[t.INCREASE_SPARK=1]="INCREASE_SPARK",t[t.LAUNCH=2]="LAUNCH",t[t.EXPLOSION=3]="EXPLOSION"}(H||(H={}));class B{constructor(t,e=null,i=0,s=4,r=10,o=15){this.canvas=e,this.angle=i,this.width=s,this.height=r,this.duration=o,this.sparks=[],this.time=0,this.stage=H.WAIT,this.sparkValue=0,this.prevValue=0,this.opacity=1,this.canBeLaunched=!0,this.pos=t.position||{x:0,y:0},this.fromPos={...this.pos},this.widthHalf=this.width/2,this.widthQuarter=this.width/4,this.heightHalf=this.height/2,this.heightQuarter=this.height/4,this.tail=new _(60,2),this.generateFinalPos(),this.generateAnchorPos(),"function"==typeof t.onLaunch&&(this.launchCallback=t.onLaunch),!1===t.canBeLaunched&&(this.canBeLaunched=!1),!0===t.autoLaunch&&this.launch(),!0===t.rocketFading&&(this.opacity=0)}getBoundingRect(){return{x:this.pos.x-(this.width<<1),y:this.pos.y-(this.height<<1),width:this.width<<2,height:this.height<<2}}get isEnded(){return this.stage===H.EXPLOSION&&this.tail.isEnded}launch(){return this.canBeLaunched?(this.stage===H.WAIT&&(this.stage=H.INCREASE_SPARK),this.launchCallback&&this.launchCallback(),this):this}interrupt(){var t;return this.opacity<1&&(this.opacity=Math.min(1,this.opacity+.1)),this.stage===H.WAIT?this.opacity<1:!1!==(null===(t=this.sound)||void 0===t?void 0:t.play())&&(this.stage!==H.INCREASE_SPARK&&this.tail.interrupt(),this.moveRocket(),this.generateSparks(),!0)}render(t){this.stage>H.INCREASE_SPARK&&(t.save(),t.fillStyle=O,this.tail.render(t),t.restore()),this.stage!==H.EXPLOSION&&(t.translate(this.pos.x,this.pos.y),t.globalAlpha=this.opacity,t.rotate(this.angle*r),this.drawRocket(t),this.stage===H.INCREASE_SPARK&&(this.sparkValue+=.1,this.sparkValue>=1&&(this.sparkValue=1,this.stage=H.LAUNCH)),this.stage>H.WAIT&&this.drawSparks(t),this.drawWings(t))}moveRocket(){if(this.stage!==H.LAUNCH)return;if(++this.time,this.time>this.duration)return this.stage=H.EXPLOSION,void(this.finishCallback&&this.finishCallback(this.pos));let t=this.time/this.duration;var e;if(t=(e=t)*e*e,t>.2)for(let e=this.prevValue;e<t;e+=.05)this.tail.addPoint(u(e,this.fromPos,this.anchorPos,this.toPos));this.prevValue=t;const i=u(t,this.fromPos,this.anchorPos,this.toPos);var s,r;this.angle=(s=i,r=this.pos,-Math.atan2(r.x-s.x,r.y-s.y)*o),this.pos=i}generateSparks(){if([H.INCREASE_SPARK,H.LAUNCH].includes(this.stage)){this.sparks=[];for(let t=0;t<20;t++){const t=a+15*(2*Math.random()-1)*r;let e=4+.5*Math.random()*4;e*=this.sparkValue;let i=30*Math.random();i*=this.sparkValue;const s=Math.cos(t),o=Math.sin(t),n=-this.widthHalf+Math.random()*this.width;this.sparks.push({x1:i*s+n,y1:i*o,x2:(i+e)*s+n,y2:(i+e)*o})}}}drawSparks(t){this.sparkGradient||(this.sparkGradient=t.createLinearGradient(-this.widthHalf+this.widthQuarter,0,this.width-this.widthHalf,12),this.sparkGradient.addColorStop(0,O),this.sparkGradient.addColorStop(.2,"rgba(255, 248, 223, 0.8)"),this.sparkGradient.addColorStop(1,"rgba(255, 248, 223, 0)")),t.fillStyle=this.sparkGradient,t.fillRect(-this.widthHalf+this.widthQuarter,0,this.width-this.widthHalf,12*this.sparkValue),t.strokeStyle=O,t.beginPath();for(const e of this.sparks)t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2);t.stroke()}generateAnchorPos(){const t=a+this.angle*r,e=Math.max(200,Math.min(400,200-this.fromPos.y));this.anchorPos={x:this.fromPos.x-Math.cos(t)*e,y:this.fromPos.y-Math.sin(t)*e}}generateFinalPos(){if(!this.canvas)return void(this.toPos={x:0,y:0});const t=Math.max(100,this.fromPos.x-300),e=Math.min(this.canvas.width-100,this.fromPos.x+300),i=Math.min(300,this.canvas.height-100);this.toPos={x:t+Math.round(Math.random()*(e-t)),y:200+Math.round(Math.random()*(i-200))}}}const z="#0e0e0e";var D;!function(t){t[t.MIN_ANGLE=-45]="MIN_ANGLE",t[t.MAX_ANGLE=45]="MAX_ANGLE",t[t.MIN_SIZE=1]="MIN_SIZE",t[t.MAX_SIZE=1.5]="MAX_SIZE"}(D||(D={}));const X="#404040";var j,V,G,Q;!function(t){t[t.MIN_ANGLE=-45]="MIN_ANGLE",t[t.MAX_ANGLE=45]="MAX_ANGLE",t[t.MIN_SIZE=1]="MIN_SIZE",t[t.MAX_SIZE=1.3]="MAX_SIZE"}(j||(j={})),function(t){t.TYPE0="type0",t.TYPE1_CIRCLE="type1-circle",t.TYPE1_SPHERE="type1-sphere",t.TYPE1_DISK="type1-disk",t.TYPE2="type2"}(V||(V={})),function(t){t.COMB1="comb1",t.COMB2="comb2",t.COMB3="comb3",t.COMB4="comb4",t.COMB5="comb5",t.COMB6="comb6"}(G||(G={})),function(t){t.TYPE0="type0",t.TYPE1="type1"}(Q||(Q={}));const q={[V.TYPE0]:E,[V.TYPE1_CIRCLE]:A,[V.TYPE1_SPHERE]:F,[V.TYPE1_DISK]:L,[V.TYPE2]:R,[G.COMB1]:class extends s{constructor(t){var e,i,s,r;super();const o=t.colors||b(1+Math.ceil(1e3*Math.random())%3),n=b(1)[0],a=new A({colors:o,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound?a.sound=null:a.sound=new v(p.EXPLOSION_FIZZ);const h=new R({colors:[n],position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(r=t.elementsFactor)&&void 0!==r?r:.5});this.add(a),this.add(h,Math.round(10.5))}},[G.COMB2]:class extends s{constructor(t){var e,i,s;super();const r=t.colors||b(1+Math.ceil(1e3*Math.random())%2),o=l(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,k.MIN_DISTANCE,k.MAX_DISTANCE),a=t.position||{x:0,y:0},h=new A({colors:r,position:a,sizeFactor:null!==(i=t.sizeFactor)&&void 0!==i?i:.5,elementsFactor:null!==(s=t.elementsFactor)&&void 0!==s?s:.5});t.noSound&&(h.sound=null),this.add(h);const c=b(2);let d=Math.ceil(6);const u=o/2;for(let e=0;e<5;e++){const i=Math.random()*n,s=Math.random()*u,r=new E({colors:[c[e%2]],position:{x:a.x+Math.cos(i)*s,y:a.y+Math.sin(i)*s},sizeFactor:0,elementsFactor:0});t.noSound&&(r.sound=null),this.add(r,d),d+=Math.ceil(3*Math.random())}}},[G.COMB3]:class extends s{constructor(t){var e,i,s,r;super();const o=t.colors||b(1+Math.ceil(1e3*Math.random())%3),n=t.colors||b(1+Math.ceil(1e3*Math.random())%2),a=new A({colors:o,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound&&(a.sound=null),this.add(a);const h=new L({colors:n,position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(r=t.elementsFactor)&&void 0!==r?r:.5});h.sound=null,this.add(h,2)}},[G.COMB4]:class extends s{constructor(t){var e;super();const i=t.colors||b(3),s=new E({colors:[i[0]],position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:0});t.noSound&&(s.sound=null),this.add(s);const r=l(t.sizeFactor,I.MIN_DISTANCE,I.MAX_DISTANCE)/2,o=t.position||{x:0,y:0};for(let e=0;e<i.length;e++){const s=Math.random()*n,a=Math.random()*r,h=new F({colors:[i[e]],position:{x:o.x+Math.cos(s)*a,y:o.y+Math.sin(s)*a},sizeFactor:t.sizeFactor,elementsFactor:t.elementsFactor});t.noSound&&(h.sound=null),this.add(h,5+3*e)}}},[G.COMB5]:class extends s{constructor(t){var e,i,s;super();const r=t.colors||b(1+Math.ceil(1e3*Math.random())%3),o=new F({colors:r,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound?o.sound=null:o.sound=new v(p.EXPLOSION_FIZZ),this.add(o);const n=new R({colors:["#ffffe7"],position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:1});this.add(n,T)}},[G.COMB6]:class extends s{constructor(t){var e,i,s,r;super();const o=b(d(2,5)),n=new E({colors:[o[0]],position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound?n.sound=null:n.sound=new v(p.EXPLOSION_2),this.add(n);for(let e=0;e<o.length;e++){const i=new L({colors:[o[e]],position:t.position||{x:0,y:0},sizeFactor:(null!==(s=t.sizeFactor)&&void 0!==s?s:.5)*d(.6,1.2),elementsFactor:null!==(r=t.elementsFactor)&&void 0!==r?r:.5});i.sound=null,this.add(i,e)}}}},U={[Q.TYPE0]:class extends B{constructor(t,e=null){var i,s;const r=l(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,D.MIN_SIZE,D.MAX_SIZE);super(t,e,l(null!==(s=t.angleFactor)&&void 0!==s?s:.5,D.MIN_ANGLE,D.MAX_ANGLE),6*r,18*r),this.color=t.rocketColors&&t.rocketColors[0]||b(1,M)[0],t.noSound||(this.sound=new v(p.LAUNCH_1))}drawRocket(t){t.fillStyle=z,t.beginPath(),t.moveTo(-this.widthHalf,-this.height),t.lineTo(0,-this.height-this.width),t.lineTo(this.widthHalf,-this.height),t.lineTo(-this.widthHalf,-this.height),t.closePath(),t.fill(),t.fillStyle=this.color,t.strokeStyle="#404040",t.beginPath(),t.rect(-this.widthHalf,-this.height,this.width,this.height),t.closePath(),t.stroke(),t.fill(),t.fillStyle=z,t.fillRect(-this.widthHalf,-4,this.width,4),t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(-this.widthQuarter,-this.height,this.widthHalf,this.height),t.fillStyle="#999173",t.fillRect(-this.widthHalf,0,2,20)}drawWings(t){}},[Q.TYPE1]:class extends B{constructor(t,e=null){var i,s;const r=l(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,j.MIN_SIZE,j.MAX_SIZE);super(t,e,l(null!==(s=t.angleFactor)&&void 0!==s?s:.5,j.MIN_ANGLE,j.MAX_ANGLE),8*r,20*r),this.color1=t.rocketColors&&t.rocketColors[0]||b(1,M)[0],this.color2=t.rocketColors&&t.rocketColors[1]||b(1,M)[0],t.noSound||(this.sound=new v(p.LAUNCH_1))}drawRocket(t){t.fillStyle=this.color1,t.strokeStyle=X,t.beginPath(),t.moveTo(-this.widthHalf-this.widthQuarter,-this.height),t.lineTo(0,-this.height-this.width-this.widthQuarter),t.lineTo(this.widthHalf+this.widthQuarter,-this.height),t.lineTo(-this.widthHalf-this.widthQuarter,-this.height),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.rect(-this.widthHalf,-this.height,this.width,this.height),t.closePath(),t.fill(),t.fillStyle=this.color2,t.fillRect(-this.widthHalf,-this.height,this.width,this.heightQuarter),t.fillRect(-this.widthHalf,2*-this.heightQuarter,this.width,this.heightQuarter),t.fillStyle="#242424",t.fillRect(-this.widthHalf,-this.heightQuarter,this.width,this.heightQuarter),t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(-this.widthQuarter,-this.height,this.widthHalf,this.height),t.beginPath(),t.moveTo(-this.widthHalf+this.widthQuarter,-this.height),t.lineTo(0,-this.height-this.width-this.widthQuarter),t.lineTo(this.widthHalf-this.widthQuarter,-this.height),t.lineTo(-this.widthHalf+this.widthQuarter,-this.height),t.closePath(),t.fill(),t.fillStyle="#8c8468",t.fillRect(-this.widthHalf,0,2,25)}drawWings(t){t.fillStyle=this.color2,t.strokeStyle=X,t.beginPath(),t.moveTo(-this.width,this.heightQuarter),t.lineTo(-this.width,-this.heightQuarter),t.lineTo(-this.widthHalf,-this.heightHalf),t.lineTo(-this.widthHalf,this.heightQuarter),t.lineTo(-this.width,this.heightQuarter),t.fill(),t.stroke(),t.beginPath(),t.moveTo(this.width,this.heightQuarter),t.lineTo(this.width,-this.heightQuarter),t.lineTo(this.widthHalf,-this.heightHalf),t.lineTo(this.widthHalf,this.heightQuarter),t.lineTo(this.width,this.heightQuarter),t.fill(),t.stroke(),t.beginPath(),t.rect(-1,-this.heightHalf,2,this.heightHalf+this.heightQuarter),t.fill(),t.stroke()}}};class W{createFirework(t,e){const i=[];let s;return W.correctFireworkData(t),t.rocketType?(s=W.createRocket(t,e),t.explosionType&&i.push(new Promise((e=>{s.finishCallback=i=>{e(W.createExplosion({...t,position:i}))}})))):t.explosionType&&(s=W.createExplosion(t)),s&&i.unshift(Promise.resolve(s)),i}getRandomFirework(t,e=!0){const i=[...Object.values(G)],s=[...Object.values(Q)];return{explosionType:i[Math.floor(Math.random()*i.length)],rocketType:s[Math.floor(Math.random()*s.length)],sizeFactor:c(),elementsFactor:c(),angleFactor:c(),rocketFading:!0,canBeLaunched:!0,position:t,autoLaunch:e}}static createExplosion(t){const e=q[t.explosionType]||null;if(!e)throw new Error("Unknown type of explosion");return new e(t)}static createRocket(t,e){const i=U[t.rocketType]||null;if(!i)throw new Error("Unknown type of rocket");return new i(t,e)}static correctFireworkData(t){var e,i;void 0!==t.sizeFactor&&(t.sizeFactor=h(+t.sizeFactor)),void 0!==t.elementsFactor&&(t.elementsFactor=h(+t.elementsFactor)),void 0!==t.angleFactor&&(t.angleFactor=h(+t.angleFactor)),void 0===t.position||"number"==typeof(null===(e=t.position)||void 0===e?void 0:e.x)&&"number"==typeof(null===(i=t.position)||void 0===i?void 0:i.y)||delete t.position}}const Z="rgba(11, 17, 34, 0.9)";class Y extends t{constructor(){super(),this.updateCanvasSize=()=>{this.canvasFront&&(this.hasAttribute("fullscreen")?(this.canvasFront.width=window.innerWidth||document.documentElement.clientWidth,this.canvasFront.height=window.innerHeight||document.documentElement.clientHeight):(this.canvasFront.width=parseInt(this.getAttribute("width"),10)||200,this.canvasFront.height=parseInt(this.getAttribute("height"),10)||100),this.canvasBack.width=this.canvasFront.width,this.canvasBack.height=this.canvasFront.height,this.rendererBack.requestRender(),this.rendererFront.requestRender())},this.bgImageLoader=Promise.resolve(),this.fireworks=new WeakMap,this.elements=new WeakMap,this.deleteList=new WeakSet,this.builder=new W}static get observedAttributes(){return["fullscreen","width","height","bg-color","bg-image","sounds-url"]}get canvas(){return this.canvasFront}async addFirework(t){let e=t.autoLaunch||!1;const i=this.builder.createFirework(t,this.canvasFront);for(const s of i){const i=await s;if(this.deleteList.has(t))return;this.fireworks.set(t,i),this.elements.set(i,t),e||!t.canBeLaunched?this.renderListFront.add(i,0,t.onBeforeRender||null,t.onAfterRender||null):this.renderListBack.add(i,0,t.onBeforeRender||null,t.onAfterRender||null),this.rendererBack.requestRender(),this.rendererFront.requestRender()}}getRandomFirework(t,e=!0){return this.builder.getRandomFirework(t,e)}removeFirework(t){if(this.deleteList.add(t),!this.fireworks.has(t))return;const e=this.fireworks.get(t);this.renderListFront.remove(e),this.renderListBack.remove(e),this.rendererBack.requestRender(),this.rendererFront.requestRender()}removeAllFireworks(){this.renderListBack.clear(),this.renderListFront.clear(),this.rendererBack.requestRender(),this.rendererFront.requestRender()}launchFirework(t){if(this.deleteList.has(t))return;if(!t.canBeLaunched)return;if(!this.fireworks.has(t))return t.autoLaunch=!0,void this.addFirework(t).then();const e=this.fireworks.get(t);e instanceof B&&e.launch()}async render(){return new Promise((t=>{this.rendererFront.requestRender(t)}))}connectedCallback(){this.renderElement(),this.updateCanvasSize(),window.addEventListener("resize",this.updateCanvasSize),this.preloadSounds(),this.bgImageLoader.then((()=>{this.rendererBack.start(),this.rendererFront.start()}))}disconnectedCallback(){this.rendererBack.finish(),this.rendererFront.finish(),window.removeEventListener("resize",this.updateCanvasSize)}renderElement(){this.createShadowDom(":host{display:block;position:relative}canvas[data-role=front]{position:absolute;left:0;top:0}",'\n\t\t\t\t<canvas data-role="back"></canvas>\n\t\t\t\t<canvas data-role="front"></canvas>\n\t\t\t'),this.canvasFront=this.shadowRoot.querySelector('canvas[data-role="front"]'),this.renderListFront=new s,this.rendererFront=new e(this.renderListFront,this.canvasFront.getContext("2d")),this.rendererFront.useGlowTail(),this.canvasBack=this.shadowRoot.querySelector('canvas[data-role="back"]'),this.renderListBack=new s,this.rendererBack=new e(this.renderListBack,this.canvasBack.getContext("2d")),this.rendererBack.backgroundColor=this.getAttribute("bg-color")||Z,this.rendererBack.observe(this.handleRender.bind(this)),this.canvasFront.addEventListener("click",this.handleClick.bind(this)),this.hasAttribute("bg-image")&&(this.bgImageLoader=this.rendererBack.setBackgroundImage(this.getAttribute("bg-image")||""))}handleRender(){this.dispatchEvent(new CustomEvent("render",{bubbles:!1,cancelable:!1,composed:!0}))}handleAttributesChange(){this.updateCanvasSize()}handleBgColorChange(){this.rendererBack&&(this.rendererBack.backgroundColor=this.getAttribute("bg-color")||Z)}handleBgImageChange(){this.rendererBack&&(this.bgImageLoader=this.rendererBack.setBackgroundImage(this.getAttribute("bg-image")||""))}preloadSounds(){this.hasAttribute("sounds-url")&&(v.assetsUrl=this.getAttribute("sounds-url"));for(const t of Object.values(p))new v(t).preloadFile()}handleClick(t){const{left:e,top:i}=this.getBoundingClientRect(),s=t.clientX-e,r=t.clientY-i,o=this.renderListBack.getElementUnderPoint({x:s,y:r});if(!(o instanceof B&&this.elements.has(o)))return;const n=this.elements.get(o);n.canBeLaunched&&(this.dispatchEvent(new CustomEvent("launch",{composed:!0,bubbles:!1,cancelable:!1,detail:n})),this.renderListFront.add(o,0,n.onBeforeRender||null,n.onAfterRender||null),this.rendererFront.requestRender((()=>{this.rendererBack.requestRender(),this.renderListBack.remove(o),o.launch()})))}}var K=i(344),$=i.n(K);class J extends t{constructor(){super(...arguments),this.canvas=null}static get observedAttributes(){return["for"]}get targetCanvas(){if(null!==this.canvas)return this.canvas;if(!this.hasAttribute("for"))return null;const t=document.getElementById(this.getAttribute("for"));return t instanceof Y?(this.canvas=t,this.canvas):null}handleForChange(){this.canvas=null}}window.customElements.define("fw-canvas",Y),window.customElements.define("fw-dev-tool",class extends J{constructor(){super(),this.createShadowDom(':host{--indent-md: 6px;--indent-sm: 4px;--font-size: 12px;--text-color: #fff;--brd-color: #888;--bg-color: #333;position:fixed;left:20px;top:20px;z-index:var(--z-index, 100001);background-color:rgba(0,0,0,.6);color:var(--text-color);border:1px solid var(--brd-color);font-size:var(--font-size);font-family:Tahoma,Helvetica,Arial,sans-serif}summary{height:20px;line-height:20px;outline:none;cursor:pointer;user-select:none;background-color:var(--bg-color);padding:var(--indent-sm) var(--indent-md)}.output-json{white-space:pre-wrap;color:var(--text-color);margin:var(--indent-md);font-family:"Courier New",monospace}.output-json:empty:before{content:"nothing to show...";font-style:italic}.random-fireworks{color:var(--text-color)}form{margin:var(--indent-md)}label{display:block;color:var(--brd-color);margin-bottom:var(--indent-sm, 3px)}select{appearance:none;width:100%;outline:none;border:none;box-sizing:border-box;color:var(--text-color);border-bottom:1px solid var(--brd-color);font-size:var(--font-size);background-color:transparent;background-image:url("data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20d%3D%22M10.293%2C3.293%2C6%2C7.586%2C1.707%2C3.293A1%2C1%2C0%2C0%2C0%2C.293%2C4.707l5%2C5a1%2C1%2C0%2C0%2C0%2C1.414%2C0l5-5a1%2C1%2C0%2C1%2C0-1.414-1.414Z%22%20fill%3D%22%23aaaaaa%22%2F%3E%3C%2Fsvg%3E");background-repeat:no-repeat;background-size:10px 10px;background-position:right center;padding:3px 20px 3px 3px;margin-bottom:var(--indent-md)}select option{color:#333;background-color:#fff}button{background:none;outline:none;color:inherit;padding:var(--indent-sm) var(--indent-md);border:1px solid var(--brd-color);cursor:pointer;font-size:var(--font-size)}button:hover{border-color:var(--txt-color)}button:active{background-color:var(--bg-color);border-color:var(--brd-color)}',$()({})),this.shadowRoot.addEventListener("add-firework-element",this.addToRenderList.bind(this)),this.shadowRoot.querySelector(".random-fireworks button").onclick=this.showRandomFirework.bind(this)}handleForChange(){super.handleForChange(),this.shadowRoot.querySelectorAll("[for]").forEach((t=>{t.setAttribute("for",this.getAttribute("for"))}))}showRandomFirework(){if(!this.targetCanvas)return;const t=this.targetCanvas.canvasFront,e=this.targetCanvas.getRandomFirework({x:t.width>>1,y:t.height-100});this.targetCanvas.addFirework(e).then()}addToRenderList(t){this.targetCanvas&&this.targetCanvas.addFirework(t.detail).then()}})})()})();